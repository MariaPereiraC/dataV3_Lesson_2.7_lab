#LAB 4

USE Sakila;
#Use the sakila database to do the following tasks:

#Write SQL queries to perform the following tasks using the Sakila database:

#1. List the number of films per category.
SELECT C.CATEGORY_ID AS CATEGORY, COUNT(C.FILM_ID)
FROM SAKILA.FILM_CATEGORY C
GROUP BY C.CATEGORY_ID;

#2. Retrieve the store ID, city, and country for each store.
SELECT S.STORE_ID AS STORE, C.CITY AS CITY, CO.COUNTRY_ID AS COUNTRY
FROM SAKILA.STORE S
JOIN SAKILA.ADDRESS A
ON S.ADDRESS_ID = A.ADDRESS_ID
JOIN SAKILA.CITY C
ON A.CITY_ID = C.CITY_ID
JOIN SAKILA.COUNTRY CO
ON C.COUNTRY_ID = CO.COUNTRY_ID
GROUP BY S.STORE_ID;



#3. Calculate the total revenue generated by each store in dollars.
SELECT S.STORE_ID AS STORE, SUM(P.AMOUNT) AS REVENUE
FROM SAKILA.STORE S
JOIN SAKILA.CUSTOMER C
ON S.STORE_ID = C.STORE_ID
JOIN SAKILA.PAYMENT P
ON P.CUSTOMER_ID = C.CUSTOMER_ID
GROUP BY S.STORE_ID;

#4. Determine the average running time of films for each category.
SELECT C.CATEGORY_ID AS CATEGORY, ROUND(AVG(F.LENGTH)) AS RUNNING_TIME_IN_MINUTES
FROM SAKILA.FILM F
JOIN SAKILA.FILM_CATEGORY AS C
ON F.FILM_ID = C.FILM_ID
GROUP BY C.CATEGORY_ID;
